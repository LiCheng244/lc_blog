<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>列表视图性能优化 | LiCheng</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="欢迎光顾!">
    <link rel="preload" href="/assets/css/0.styles.16c06408.css" as="style"><link rel="preload" href="/assets/js/app.22d06e00.js" as="script"><link rel="preload" href="/assets/js/3.76a73c92.js" as="script"><link rel="preload" href="/assets/js/29.6950f0e0.js" as="script"><link rel="prefetch" href="/assets/js/10.31a2655e.js"><link rel="prefetch" href="/assets/js/100.4f3e3468.js"><link rel="prefetch" href="/assets/js/101.77663bdb.js"><link rel="prefetch" href="/assets/js/102.16b89b41.js"><link rel="prefetch" href="/assets/js/103.2814d483.js"><link rel="prefetch" href="/assets/js/104.4202cfd4.js"><link rel="prefetch" href="/assets/js/105.0cfe3b70.js"><link rel="prefetch" href="/assets/js/106.d9653ded.js"><link rel="prefetch" href="/assets/js/107.2f1327db.js"><link rel="prefetch" href="/assets/js/108.a31d9fcf.js"><link rel="prefetch" href="/assets/js/109.7526ae34.js"><link rel="prefetch" href="/assets/js/11.e545768f.js"><link rel="prefetch" href="/assets/js/110.c2078e4b.js"><link rel="prefetch" href="/assets/js/111.dfa968f7.js"><link rel="prefetch" href="/assets/js/112.456b8cc0.js"><link rel="prefetch" href="/assets/js/113.b578e0d7.js"><link rel="prefetch" href="/assets/js/114.0c9685b6.js"><link rel="prefetch" href="/assets/js/115.f0d7e66c.js"><link rel="prefetch" href="/assets/js/116.47d869b4.js"><link rel="prefetch" href="/assets/js/117.5f6e397a.js"><link rel="prefetch" href="/assets/js/118.357ec821.js"><link rel="prefetch" href="/assets/js/119.b1646524.js"><link rel="prefetch" href="/assets/js/12.0dbfbb95.js"><link rel="prefetch" href="/assets/js/120.35521229.js"><link rel="prefetch" href="/assets/js/121.d374a14e.js"><link rel="prefetch" href="/assets/js/122.be0ebc88.js"><link rel="prefetch" href="/assets/js/123.f3b97421.js"><link rel="prefetch" href="/assets/js/124.9b7c8185.js"><link rel="prefetch" href="/assets/js/125.c458f5e1.js"><link rel="prefetch" href="/assets/js/126.b97b1a0e.js"><link rel="prefetch" href="/assets/js/127.896802c3.js"><link rel="prefetch" href="/assets/js/128.29c79ddc.js"><link rel="prefetch" href="/assets/js/129.3711190a.js"><link rel="prefetch" href="/assets/js/13.2a1e46e6.js"><link rel="prefetch" href="/assets/js/130.6f07b6e9.js"><link rel="prefetch" href="/assets/js/131.a0b04d20.js"><link rel="prefetch" href="/assets/js/132.5e6a422b.js"><link rel="prefetch" href="/assets/js/133.27f50767.js"><link rel="prefetch" href="/assets/js/134.daffe85c.js"><link rel="prefetch" href="/assets/js/135.47442629.js"><link rel="prefetch" href="/assets/js/136.931c358e.js"><link rel="prefetch" href="/assets/js/137.a1a903ad.js"><link rel="prefetch" href="/assets/js/138.4204d631.js"><link rel="prefetch" href="/assets/js/139.fcfb07e2.js"><link rel="prefetch" href="/assets/js/14.e4b12223.js"><link rel="prefetch" href="/assets/js/140.88def9c3.js"><link rel="prefetch" href="/assets/js/141.e17076b6.js"><link rel="prefetch" href="/assets/js/142.fc09a55f.js"><link rel="prefetch" href="/assets/js/143.ea95cb74.js"><link rel="prefetch" href="/assets/js/144.a4695cb4.js"><link rel="prefetch" href="/assets/js/145.db98be3c.js"><link rel="prefetch" href="/assets/js/146.978e7445.js"><link rel="prefetch" href="/assets/js/147.04e71995.js"><link rel="prefetch" href="/assets/js/148.e83ab40f.js"><link rel="prefetch" href="/assets/js/149.aabacfd6.js"><link rel="prefetch" href="/assets/js/15.d1fb8ce8.js"><link rel="prefetch" href="/assets/js/150.2518f07b.js"><link rel="prefetch" href="/assets/js/151.2837ee15.js"><link rel="prefetch" href="/assets/js/152.d03f7e42.js"><link rel="prefetch" href="/assets/js/153.ca4a032f.js"><link rel="prefetch" href="/assets/js/154.939abdab.js"><link rel="prefetch" href="/assets/js/155.9f6efb01.js"><link rel="prefetch" href="/assets/js/156.01fa1415.js"><link rel="prefetch" href="/assets/js/157.b3a28578.js"><link rel="prefetch" href="/assets/js/158.ed4593de.js"><link rel="prefetch" href="/assets/js/159.80f45c4b.js"><link rel="prefetch" href="/assets/js/16.a269dbe6.js"><link rel="prefetch" href="/assets/js/160.71f58f9b.js"><link rel="prefetch" href="/assets/js/161.431164d3.js"><link rel="prefetch" href="/assets/js/162.7ebd617a.js"><link rel="prefetch" href="/assets/js/163.5b57f695.js"><link rel="prefetch" href="/assets/js/164.776d8f0a.js"><link rel="prefetch" href="/assets/js/165.f1d9824e.js"><link rel="prefetch" href="/assets/js/166.416857e6.js"><link rel="prefetch" href="/assets/js/167.5d2d86d2.js"><link rel="prefetch" href="/assets/js/168.d91fe6a8.js"><link rel="prefetch" href="/assets/js/169.81611e8c.js"><link rel="prefetch" href="/assets/js/17.0720c51c.js"><link rel="prefetch" href="/assets/js/170.c653d801.js"><link rel="prefetch" href="/assets/js/171.3711258d.js"><link rel="prefetch" href="/assets/js/172.2529bbe1.js"><link rel="prefetch" href="/assets/js/173.5167390d.js"><link rel="prefetch" href="/assets/js/174.b1ca7994.js"><link rel="prefetch" href="/assets/js/175.e7c93e72.js"><link rel="prefetch" href="/assets/js/176.e4297e19.js"><link rel="prefetch" href="/assets/js/177.3e08857d.js"><link rel="prefetch" href="/assets/js/178.d1f70ffc.js"><link rel="prefetch" href="/assets/js/179.51b70b50.js"><link rel="prefetch" href="/assets/js/18.7aa6f4b8.js"><link rel="prefetch" href="/assets/js/180.bf9a3dd8.js"><link rel="prefetch" href="/assets/js/181.5809e2c2.js"><link rel="prefetch" href="/assets/js/182.3a01f4ff.js"><link rel="prefetch" href="/assets/js/183.45cb8f0f.js"><link rel="prefetch" href="/assets/js/184.0c31c762.js"><link rel="prefetch" href="/assets/js/185.ce513e6f.js"><link rel="prefetch" href="/assets/js/186.378145b5.js"><link rel="prefetch" href="/assets/js/187.c7cf1de1.js"><link rel="prefetch" href="/assets/js/188.5ca4a886.js"><link rel="prefetch" href="/assets/js/189.04828c7a.js"><link rel="prefetch" href="/assets/js/19.3c5a8a61.js"><link rel="prefetch" href="/assets/js/190.2ec510cf.js"><link rel="prefetch" href="/assets/js/191.270a35ea.js"><link rel="prefetch" href="/assets/js/192.1bd094f8.js"><link rel="prefetch" href="/assets/js/193.71a797dd.js"><link rel="prefetch" href="/assets/js/194.6028cba3.js"><link rel="prefetch" href="/assets/js/195.9c526306.js"><link rel="prefetch" href="/assets/js/196.e4387fdd.js"><link rel="prefetch" href="/assets/js/197.8a457e36.js"><link rel="prefetch" href="/assets/js/198.a35d7d19.js"><link rel="prefetch" href="/assets/js/199.aac323d9.js"><link rel="prefetch" href="/assets/js/2.c0cdc9c1.js"><link rel="prefetch" href="/assets/js/20.1bf6402a.js"><link rel="prefetch" href="/assets/js/200.162caedb.js"><link rel="prefetch" href="/assets/js/201.5a2da6f8.js"><link rel="prefetch" href="/assets/js/202.440a78fa.js"><link rel="prefetch" href="/assets/js/203.6294f573.js"><link rel="prefetch" href="/assets/js/204.fd141912.js"><link rel="prefetch" href="/assets/js/205.036efab9.js"><link rel="prefetch" href="/assets/js/206.fcd23e30.js"><link rel="prefetch" href="/assets/js/207.c28c6f79.js"><link rel="prefetch" href="/assets/js/208.106ad1d6.js"><link rel="prefetch" href="/assets/js/21.807f2715.js"><link rel="prefetch" href="/assets/js/22.c68b53d4.js"><link rel="prefetch" href="/assets/js/23.b4d581d8.js"><link rel="prefetch" href="/assets/js/24.9944d993.js"><link rel="prefetch" href="/assets/js/25.c8d28f03.js"><link rel="prefetch" href="/assets/js/26.3f8bf1b8.js"><link rel="prefetch" href="/assets/js/27.af871949.js"><link rel="prefetch" href="/assets/js/28.5ff56176.js"><link rel="prefetch" href="/assets/js/30.41dfc08d.js"><link rel="prefetch" href="/assets/js/31.57078b6c.js"><link rel="prefetch" href="/assets/js/32.64360c62.js"><link rel="prefetch" href="/assets/js/33.79a9c504.js"><link rel="prefetch" href="/assets/js/34.88d6a304.js"><link rel="prefetch" href="/assets/js/35.8bddbb91.js"><link rel="prefetch" href="/assets/js/36.cfe4b166.js"><link rel="prefetch" href="/assets/js/37.629057cd.js"><link rel="prefetch" href="/assets/js/38.ebc80cbd.js"><link rel="prefetch" href="/assets/js/39.435ca712.js"><link rel="prefetch" href="/assets/js/4.a139e404.js"><link rel="prefetch" href="/assets/js/40.bb99c452.js"><link rel="prefetch" href="/assets/js/41.34aeb94f.js"><link rel="prefetch" href="/assets/js/42.2be49885.js"><link rel="prefetch" href="/assets/js/43.279b0cfc.js"><link rel="prefetch" href="/assets/js/44.1472b929.js"><link rel="prefetch" href="/assets/js/45.d785096e.js"><link rel="prefetch" href="/assets/js/46.082382bb.js"><link rel="prefetch" href="/assets/js/47.234f8689.js"><link rel="prefetch" href="/assets/js/48.80d427e1.js"><link rel="prefetch" href="/assets/js/49.e7a794b3.js"><link rel="prefetch" href="/assets/js/5.48d8758d.js"><link rel="prefetch" href="/assets/js/50.c7b49a71.js"><link rel="prefetch" href="/assets/js/51.a63e8285.js"><link rel="prefetch" href="/assets/js/52.1398ba35.js"><link rel="prefetch" href="/assets/js/53.4c38b1e7.js"><link rel="prefetch" href="/assets/js/54.33d80fd4.js"><link rel="prefetch" href="/assets/js/55.b7bd910b.js"><link rel="prefetch" href="/assets/js/56.baac762f.js"><link rel="prefetch" href="/assets/js/57.538a600d.js"><link rel="prefetch" href="/assets/js/58.1236d41e.js"><link rel="prefetch" href="/assets/js/59.0c25922e.js"><link rel="prefetch" href="/assets/js/6.f6ecc1e5.js"><link rel="prefetch" href="/assets/js/60.daf725cf.js"><link rel="prefetch" href="/assets/js/61.a50ed9a3.js"><link rel="prefetch" href="/assets/js/62.ca2340b6.js"><link rel="prefetch" href="/assets/js/63.7c2b9ed3.js"><link rel="prefetch" href="/assets/js/64.69064517.js"><link rel="prefetch" href="/assets/js/65.267d16c5.js"><link rel="prefetch" href="/assets/js/66.afdfd28f.js"><link rel="prefetch" href="/assets/js/67.5173bd7c.js"><link rel="prefetch" href="/assets/js/68.2c6dde2f.js"><link rel="prefetch" href="/assets/js/69.9bde1331.js"><link rel="prefetch" href="/assets/js/7.253e7e36.js"><link rel="prefetch" href="/assets/js/70.ca00022c.js"><link rel="prefetch" href="/assets/js/71.0beff1fd.js"><link rel="prefetch" href="/assets/js/72.d1631e30.js"><link rel="prefetch" href="/assets/js/73.6320b125.js"><link rel="prefetch" href="/assets/js/74.fc8c0a22.js"><link rel="prefetch" href="/assets/js/75.6b93b664.js"><link rel="prefetch" href="/assets/js/76.62bcf617.js"><link rel="prefetch" href="/assets/js/77.e7abe148.js"><link rel="prefetch" href="/assets/js/78.a719ed7e.js"><link rel="prefetch" href="/assets/js/79.463d85f9.js"><link rel="prefetch" href="/assets/js/8.51da75e6.js"><link rel="prefetch" href="/assets/js/80.1aa6a172.js"><link rel="prefetch" href="/assets/js/81.ca5949e6.js"><link rel="prefetch" href="/assets/js/82.224318c6.js"><link rel="prefetch" href="/assets/js/83.bdd8dfd0.js"><link rel="prefetch" href="/assets/js/84.27e1f635.js"><link rel="prefetch" href="/assets/js/85.c317281e.js"><link rel="prefetch" href="/assets/js/86.9f43c383.js"><link rel="prefetch" href="/assets/js/87.21a534d1.js"><link rel="prefetch" href="/assets/js/88.f3d9e2f9.js"><link rel="prefetch" href="/assets/js/89.980ca2d3.js"><link rel="prefetch" href="/assets/js/9.16784830.js"><link rel="prefetch" href="/assets/js/90.3cb9b535.js"><link rel="prefetch" href="/assets/js/91.36ca0022.js"><link rel="prefetch" href="/assets/js/92.0bdf50be.js"><link rel="prefetch" href="/assets/js/93.22858350.js"><link rel="prefetch" href="/assets/js/94.4ba2b55d.js"><link rel="prefetch" href="/assets/js/95.9b7c9258.js"><link rel="prefetch" href="/assets/js/96.a9b30fc7.js"><link rel="prefetch" href="/assets/js/97.642a5ee0.js"><link rel="prefetch" href="/assets/js/98.70595e29.js"><link rel="prefetch" href="/assets/js/99.a663e6a0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.16c06408.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="LiCheng" class="logo"> <span class="site-name can-hide">LiCheng</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/game/" class="nav-link router-link-active">
  游戏
</a></div><div class="nav-item"><a href="/product/" class="nav-link">
  产品
</a></div><div class="nav-item"><a href="/ios/" class="nav-link">
  iOS
</a></div><div class="nav-item"><a href="/essay/" class="nav-link">
  好文
</a></div><div class="nav-item"><a href="https://github.com/LiCheng244/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/game/" class="nav-link router-link-active">
  游戏
</a></div><div class="nav-item"><a href="/product/" class="nav-link">
  产品
</a></div><div class="nav-item"><a href="/ios/" class="nav-link">
  iOS
</a></div><div class="nav-item"><a href="/essay/" class="nav-link">
  好文
</a></div><div class="nav-item"><a href="https://github.com/LiCheng244/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/game/00基础知识/" class="sidebar-heading clickable"><span>基础知识</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/game/01JavaScript/" class="sidebar-heading clickable"><span>JavaScript</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/game/05Creator/" class="sidebar-heading clickable"><span>Creator</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/game/04性能优化/" class="sidebar-heading clickable open"><span>性能优化</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/game/04性能优化/性能指标.html" class="sidebar-link">关于 性能优化指标</a></li><li><a href="/game/04性能优化/批处理.html" class="sidebar-link">关于 批处理（合批）</a></li><li><a href="/game/04性能优化/压缩纹理.html" class="sidebar-link">关于 压缩纹理</a></li><li><a href="/game/04性能优化/静态合图.html" class="sidebar-link">关于 静态合图</a></li><li><a href="/game/04性能优化/动态合图.html" class="sidebar-link">关于 动态合图</a></li><li><a href="/game/04性能优化/渲染性能.html" class="sidebar-link">关于 渲染性能优化</a></li><li><a href="/game/04性能优化/内存管理.html" class="sidebar-link">关于 内存管理</a></li><li><a href="/game/04性能优化/drawcall.html" class="sidebar-link">如何降低 DrawCall</a></li><li><a href="/game/04性能优化/优化包体大小.html" class="sidebar-link">如何优化包体大小</a></li><li><a href="/game/04性能优化/滚动视图.html" class="active sidebar-link">列表视图性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/game/04性能优化/滚动视图.html#一-实现方式" class="sidebar-link">一. 实现方式</a></li><li class="sidebar-sub-header"><a href="/game/04性能优化/滚动视图.html#二-表现效果" class="sidebar-link">二. 表现效果</a></li><li class="sidebar-sub-header"><a href="/game/04性能优化/滚动视图.html#三-代码逻辑" class="sidebar-link">三. 代码逻辑</a></li><li class="sidebar-sub-header"><a href="/game/04性能优化/滚动视图.html#四-使用方式" class="sidebar-link">四. 使用方式</a></li></ul></li><li><a href="/game/04性能优化/TexturePacker.html" class="sidebar-link">TexturePacker黑边问题</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/game/07Shader/" class="sidebar-heading clickable"><span>Shader</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/game/02TypeScript/" class="sidebar-link">TypeScript</a></li><li><a href="/game/03%E5%BE%AE%E4%BF%A1%E5%B0%8F%E6%B8%B8%E6%88%8F/" class="sidebar-link">微信小游戏</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/game/06面试题/" class="sidebar-heading clickable"><span>面试题</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1> 列表视图性能优化 </h1> <div class="custom-block tip"><p class="custom-block-title">前言</p> <p>滚动列表，这种东西在游戏中很常见。而cocos creator 中的 <code>ScrollView + Layout</code> 基本可以实现大部分需求，但如果是 <strong>背包系统、排行榜、好友列表功能等</strong>数据量庞大的列表，<code>ScrollView + Layout</code> 会严重影响性能。</p></div> <br> <h2 id="一-实现方式"><a href="#一-实现方式" class="header-anchor">#</a> 一. 实现方式</h2> <p>在创建多个类表项的时候，只需要创建超过屏幕范围数量的 <code>Item</code>，然后，只需要增加 <code>content</code> 的长度，到所有 <code>item</code> 的长度之后，就可以了。</p> <p>在滑动的时候，按照上面的逻辑处理，就可以实现循环滚动。</p> <p><img src="/assets/img/220112001.e3e98b6c.png" alt=""></p> <br> <h2 id="二-表现效果"><a href="#二-表现效果" class="header-anchor">#</a> 二. 表现效果</h2> <p><img src="/assets/img/220112003.f096e1fb.gif" alt=""></p> <h3 id="_1-布局方式："><a href="#_1-布局方式：" class="header-anchor">#</a> 1. 布局方式：</h3> <p>支持: 垂直布局，水平布局，网格布局(水平网格、垂直网格)</p> <h3 id="_2-功能"><a href="#_2-功能" class="header-anchor">#</a> 2. 功能:</h3> <ul><li>在末尾增加一项；</li> <li>在末尾增加一列；</li> <li>在指定位置添加一项；</li> <li>删除某一项；</li> <li>更改某一项；</li> <li>手动滚动到顶部；</li> <li>手动滚动到底部；</li> <li>手动滚动到某一项；</li> <li>监听滚动到顶部；</li> <li>监听滚动到底部；</li></ul> <br> <h2 id="三-代码逻辑"><a href="#三-代码逻辑" class="header-anchor">#</a> 三. 代码逻辑</h2> <p>自定义组件： <code>ListView.js</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/** ============================= 枚举值 ============================= */</span>
<span class="token comment">/**
 * 列表排列方式
 */</span>
<span class="token keyword">const</span> ListType <span class="token operator">=</span> cc<span class="token punctuation">.</span><span class="token function">Enum</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    <span class="token comment">// 水平排列</span>
    Horizontal<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token comment">// 垂直排列</span>
    Vertical<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token comment">// 网格排列</span>
    Grid<span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 网格布局中的方向
 */</span>
<span class="token keyword">const</span> GridAxisType <span class="token operator">=</span> cc<span class="token punctuation">.</span><span class="token function">Enum</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

    <span class="token comment">// 水平排列</span>
    Horizontal<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token comment">// 垂直排列</span>
    Vertical<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/** ================================================================ */</span>


cc<span class="token punctuation">.</span><span class="token function">Class</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> cc<span class="token punctuation">.</span>Component<span class="token punctuation">,</span>

    editor<span class="token operator">:</span><span class="token punctuation">{</span>
        menu<span class="token operator">:</span><span class="token string">&quot;自定义组件/ListView&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    properties<span class="token operator">:</span> <span class="token punctuation">{</span>

        <span class="token comment">/** ============================= 属性面板 ============================= */</span>

        listType<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> ListType<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'排列方式'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        listItem<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Node<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表项：Node节点'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        itemName<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'itemName'</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表项：脚本名称'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        gridAxisType<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> GridAxisType<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'网格布局的方向'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        spaceX<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Float<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表项: 之间的 x 间距'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        spaceY<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Float<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表项: 之间的 y 间距'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        paddingTop <span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Float<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表: 上间距'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        paddingBottom <span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Float<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表: 下间距'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        paddingLeft <span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Float<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表: 左间距'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        paddingRight <span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Float<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表: 右间距'</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        scrollTopEvent<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Component<span class="token punctuation">.</span>EventHandler<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表: 滚动到顶部时会触发该回调'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        scrollBottomEvent<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> cc<span class="token punctuation">.</span>Component<span class="token punctuation">.</span>EventHandler<span class="token punctuation">,</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            tooltip<span class="token operator">:</span> <span class="token string">'列表: 滚动到底部时会触发该回调'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** ============================= 系统方法 ============================= */</span>

    <span class="token function">ctor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListTypeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">onLoad</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// ====================== 滚动容器 ===============================</span>
        <span class="token comment">// 列表容器</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span>cc<span class="token punctuation">.</span>ScrollView<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 列表内容容器</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>anchorX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>anchorY <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">removeAllChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_initListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//======================== 列表项 ===========================</span>
        <span class="token comment">// 列表项数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 应创建的实例数量</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// 存放列表项实例的数组</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// item的高度</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listItem<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
        <span class="token comment">// item的宽度</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listItem<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
        <span class="token comment">// 存放不再使用中的列表项 */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemPool <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">//======================= 计算参数 ==========================</span>

        <span class="token comment">// 距离scrollView中心点的距离，超过这个距离的item会被重置，</span>
        <span class="token comment">// 一般设置为 scrollVIew.height/2 + item.heigt/2 + space，因为这个距离item正好超出scrollView显示范围</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">// 上一次content的X值</span>
        <span class="token comment">// 用于和现在content的X值比较，得出是向左还是向右滚动</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">//上一次content的Y值</span>
        <span class="token comment">// 用于和现在content的Y值比较，得出是向上还是向下滚动</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">// 网格行数</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// 网格列数</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// 刷新时间，单位s</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>updateTimer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// 刷新间隔，单位s</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>updateInterval <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">;</span>
        <span class="token comment">// 是否滚动容器</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bScrolling <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">update</span> <span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bScrolling <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>updateTimer <span class="token operator">+=</span> dt<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>updateTimer <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>updateInterval<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>updateTimer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bScrolling <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateArrange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">onDestroy</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 清理列表项</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cc<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">destory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">// 清理对象池</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemPool<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cc<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>itemPool<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">destory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemPool<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>


        <span class="token comment">// 清理列表数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** ============================= 公共方法 ============================= */</span>

    <span class="token comment">/**
     * 设置列表数据
     * (列表数据重复使用，如果列表数据改变，则需要重新设置一遍数据)
     *
     * @param data  item 数据列表
     */</span>
    <span class="token function">setData</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 获取列表数据
     */</span>
    <span class="token function">getListData</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * 添加一项数据到列表的末尾
     *
     * @param data      数据
     */</span>
    <span class="token function">addItem</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 添加一组数据到列表的末尾
     *
     * @param dataList  数据列表
     */</span>
    <span class="token function">addItems</span> <span class="token punctuation">(</span><span class="token parameter">dataList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dataList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> data <span class="token operator">=</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * 添加一项数据到列表的指定位置
     *
     * @param data      数据
     * @param index     索引 (从 0 开始)
     */</span>
    <span class="token function">addItemAtIndex</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length <span class="token operator">==</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * 删除一项数据
     *
     * @param index     索引 (从 0 开始)
     */</span>
    <span class="token function">deleteItem</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * 改变一项数据
     *
     * @param data      数据
     * @param index     索引 (从 0 开始)
     */</span>
    <span class="token function">changeItem</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * 滚动到顶部
     */</span>
    <span class="token function">scrollToTop</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 滚动到底部
     */</span>
    <span class="token function">scrollToBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">scrollToIndex</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * 滚动到指定索引
     *
     * @param index     索引
     */</span>
    <span class="token function">scrollToIndex</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startScroll<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'列表还在滚动中'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createList</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> cc<span class="token punctuation">.</span><span class="token function">v2</span><span class="token punctuation">(</span>index <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createList</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> cc<span class="token punctuation">.</span><span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>index <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> gridCol <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>index <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> width   <span class="token operator">=</span> gridCol <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token punctuation">(</span>gridCol <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createList</span><span class="token punctuation">(</span>gridCol <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">,</span> cc<span class="token punctuation">.</span><span class="token function">v2</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> gridRow <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>index <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> height <span class="token operator">=</span> gridRow <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token punctuation">(</span>gridRow <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createList</span><span class="token punctuation">(</span>gridRow<span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">,</span> cc<span class="token punctuation">.</span><span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ============================= 私有方法 ============================= */</span>

    <span class="token function">_initListener</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-began'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollBegin<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-ended'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollEnded<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scrolling'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrolling<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-left'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToTop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-right'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToBottom<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-top'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToTop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-bottom'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToBottom<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Grid<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-left'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToTop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-right'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToBottom<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-top'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToTop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'scroll-to-bottom'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onScrollToBottom<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** ok 获取第一个 item 位置 */</span>
    <span class="token function">_updateContent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 显示列表实例为 0 个</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_countListParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createList</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> cc<span class="token punctuation">.</span><span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">-</span> b<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> b<span class="token punctuation">.</span>y <span class="token operator">-</span> a<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Grid<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> b<span class="token punctuation">.</span>y <span class="token operator">-</span> a<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">-</span> b<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">-</span> b<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> b<span class="token punctuation">.</span>y <span class="token operator">-</span> a<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_countListParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> startIndex <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">.</span>itemIndex<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Grid <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            startIndex <span class="token operator">+=</span> <span class="token punctuation">(</span>startIndex <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Grid <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            startIndex <span class="token operator">+=</span> <span class="token punctuation">(</span>startIndex <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> offset <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span><span class="token function">getScrollOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        offset<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span>offset<span class="token punctuation">.</span>x<span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'--------'</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_createList</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 计算列表参数 */</span>
    <span class="token function">_countListParam</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> dataLen <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token comment">// spawnCount, 比当前scrollView容器能放下的item数量再加上2个</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> padding <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight<span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>horizontal  <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>vertical    <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width          <span class="token operator">=</span> dataLen <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token punctuation">(</span>dataLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">+</span> padding<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height         <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount             <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView         <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> padding <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom<span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>horizontal  <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>vertical    <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width          <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height         <span class="token operator">=</span> dataLen <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token punctuation">(</span>dataLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">+</span> padding<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount             <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView         <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> paddingL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight<span class="token punctuation">;</span>
            <span class="token keyword">let</span> paddingT <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom<span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>horizontal  <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>vertical    <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height         <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>height<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingT <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop     <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;paddingTop 或 paddingBottom 过大&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow        <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height <span class="token operator">-</span> paddingT<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol        <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>dataLen <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridCol <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">+</span> paddingL<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount     <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> paddingL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight<span class="token punctuation">;</span>
            <span class="token keyword">let</span> paddingT <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom<span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>horizontal  <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>vertical    <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width         <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>width<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingL <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft   <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;paddingTop 或 paddingBottom 过大&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol        <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width <span class="token operator">-</span> paddingL<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow        <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>dataLen <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridRow <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">+</span> paddingT<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount     <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/**
     * ok 创建列表
     *
     * @param startIndex    起始显示的数据索引 0 表示第一项
     * @param offset        scrollView 偏移量
     */</span>
    <span class="token function">_createList</span> <span class="token punctuation">(</span><span class="token parameter">startIndex<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>startIndex <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 当需要显示的长度 &gt; 虚拟列表长度， 删除末尾几个数据时，列表需要重置位置到最低端</span>

            startIndex <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount<span class="token punctuation">;</span>
            offset <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span><span class="token function">getMaxScrollOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 当需要显示的长度 &lt;= 虚拟列表长度，隐藏多余的虚拟列表项</span>

            startIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 需要显示的数据索引在范围内： item显示</span>

                item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// 需要显示的数据索引超过了数据范围，item 隐藏</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">.</span>length <span class="token operator">-</span> startIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span><span class="token function">removeFromParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>itemPool<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> i <span class="token operator">+</span> startIndex<span class="token punctuation">;</span>
            itemComponent<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
            itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 因为content的锚点X是0 :</span>
            <span class="token comment">// 所以item的x值: 是content.with/2表示居中，锚点Y是1，</span>
            <span class="token comment">// 所以item的y值: 从content顶部向下是0到负无穷。所以item.y= -item.height/2时，是在content的顶部。</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">let</span> x <span class="token operator">=</span> item<span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">+</span> i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft<span class="token punctuation">;</span>
                <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
                item<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
                <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">-</span>item<span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">+</span> i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop<span class="token punctuation">;</span>
                item<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Grid<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> col <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> x   <span class="token operator">=</span> item<span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">+</span> col<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">*</span> col <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> y   <span class="token operator">=</span> <span class="token operator">-</span>item<span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">+</span> row<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">*</span> row <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop<span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">let</span> row <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> col <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> startIndex<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> x   <span class="token operator">=</span> item<span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">+</span> col<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX <span class="token operator">*</span> col <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft<span class="token punctuation">;</span>
                    <span class="token keyword">let</span> y   <span class="token operator">=</span> <span class="token operator">-</span>item<span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">+</span> row<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY <span class="token operator">*</span> row <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop<span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>opacity <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span><span class="token function">scrollToOffset</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 从对象池中获取节点 */</span>
    <span class="token function">_getItem</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemPool<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> cc<span class="token punctuation">.</span><span class="token function">instantiate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemPool<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 获取item在scrollView的局部坐标 */</span>
    <span class="token function">_getPositionInView</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> worldPos <span class="token operator">=</span> item<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">convertToWorldSpaceAR</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> viewPos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>node<span class="token punctuation">.</span><span class="token function">convertToNodeSpaceAR</span><span class="token punctuation">(</span>worldPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> viewPos<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 更新排列 */</span>
    <span class="token function">_updateArrange</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateVertical</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateGridHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gridAxisType <span class="token operator">==</span> GridAxisType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateGridVertical</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 更新水平排列 */</span>
    <span class="token function">_updateHorizontal</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> items       <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">;</span>
        <span class="token keyword">let</span> item        <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> bufferZone  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView<span class="token punctuation">;</span>
        <span class="token keyword">let</span> isRight     <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosX<span class="token punctuation">;</span>
        <span class="token keyword">let</span> offset      <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">)</span> <span class="token operator">*</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            item <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> viewPos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPositionInView</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isRight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//item右滑时，超出了scrollView右边界，将item移动到左方复用，item移动到左方的位置必须不超过content的左边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>x <span class="token operator">-</span> offset <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">-</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>x <span class="token operator">=</span> item<span class="token punctuation">.</span>x <span class="token operator">-</span> offset<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">//item左滑时，超出了scrollView左边界，将item移动到右方复用，item移动到右方的位置必须不超过content的右边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token operator">-</span>bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>x <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">+</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>x <span class="token operator">=</span> item<span class="token punctuation">.</span>x <span class="token operator">+</span> offset<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosX <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 更新垂直排列 */</span>
    <span class="token function">_updateVertical</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> items       <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">;</span>
        <span class="token keyword">let</span> item        <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> bufferZone  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView<span class="token punctuation">;</span>
        <span class="token keyword">let</span> isUp        <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosY<span class="token punctuation">;</span>
        <span class="token keyword">let</span> offset      <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">)</span> <span class="token operator">*</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            item <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> viewPos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPositionInView</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isUp<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token comment">//item上滑时，超出了scrollView上边界，将item移动到下方复用，item移动到下方的位置必须不超过content的下边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>y <span class="token operator">-</span> offset <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">+</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>y <span class="token operator">=</span> item<span class="token punctuation">.</span>y <span class="token operator">-</span> offset<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">//item下滑时，超出了scrollView下边界，将item移动到上方复用，item移动到上方的位置必须不超过content的上边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token operator">-</span>bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>y <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">-</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    item<span class="token punctuation">.</span>y <span class="token operator">=</span> item<span class="token punctuation">.</span>y <span class="token operator">+</span> offset<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosY <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 更新网格水平排列 */</span>
    <span class="token function">_updateGridHorizontal</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> items       <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">;</span>
        <span class="token keyword">let</span> item        <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> bufferZone  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView<span class="token punctuation">;</span>
        <span class="token keyword">let</span> isRight     <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosX<span class="token punctuation">;</span>
        <span class="token keyword">let</span> offset      <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceX<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            item <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> viewPos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPositionInView</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isRight<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token comment">//item右滑时，超出了scrollView右边界，将item移动到左方复用，item移动到左方的位置必须不超过content的左边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>x <span class="token operator">-</span> offset <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingLeft <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>x          <span class="token operator">=</span> item<span class="token punctuation">.</span>x <span class="token operator">-</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>data      <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>x          <span class="token operator">=</span> item<span class="token punctuation">.</span>x <span class="token operator">-</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

                <span class="token comment">//item左滑时，超出了scrollView左边界，将item移动到右方复用，item移动到右方的位置必须不超过content的右边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token operator">-</span>bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>x <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingRight <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>width<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridRow<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>x          <span class="token operator">=</span> item<span class="token punctuation">.</span>x <span class="token operator">+</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>data      <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>x          <span class="token operator">=</span> item<span class="token punctuation">.</span>x <span class="token operator">+</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosX <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** ok 更新网格垂直排列 */</span>
    <span class="token function">_updateGridVertical</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> items       <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemList<span class="token punctuation">;</span>
        <span class="token keyword">let</span> item        <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> bufferZone  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>halfScrollView<span class="token punctuation">;</span>
        <span class="token keyword">let</span> isUp        <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosY<span class="token punctuation">;</span>
        <span class="token keyword">let</span> offset      <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>spaceY<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            item <span class="token operator">=</span> items<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> viewPos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPositionInView</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>isUp<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token comment">//item上滑时，超出了scrollView上边界，将item移动到下方复用，item移动到下方的位置必须不超过content的下边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>y <span class="token operator">&gt;</span> bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>y <span class="token operator">-</span> offset <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingBottom <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>y          <span class="token operator">=</span> item<span class="token punctuation">.</span>y <span class="token operator">-</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>data      <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>y          <span class="token operator">=</span> item<span class="token punctuation">.</span>y <span class="token operator">-</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

                <span class="token comment">//item下滑时，超出了scrollView下边界，将item移动到上方复用，item移动到上方的位置必须不超过content的上边界</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>viewPos<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token operator">-</span>bufferZone <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>y <span class="token operator">+</span> offset <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>paddingTop <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">let</span> itemComponent <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">let</span> itemIndex <span class="token operator">=</span> itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>spawnCount <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gridCol<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>y          <span class="token operator">=</span> item<span class="token punctuation">.</span>y <span class="token operator">+</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>data      <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemDataList<span class="token punctuation">[</span>itemIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span><span class="token function">dataChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        item<span class="token punctuation">.</span>y          <span class="token operator">=</span> item<span class="token punctuation">.</span>y <span class="token operator">+</span> offset<span class="token punctuation">;</span>
                        itemComponent<span class="token punctuation">.</span>itemIndex <span class="token operator">=</span> itemIndex<span class="token punctuation">;</span>
                        item<span class="token punctuation">.</span>opacity    <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>lastContentPosY <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollView<span class="token punctuation">.</span>content<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>



    <span class="token comment">/** ============================= 属性面板 ============================= */</span>


    <span class="token comment">/**
     * 列表排列方式改变
     */</span>
    <span class="token function">onListTypeChange</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'gridAxisType'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'spaceX'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'spaceY'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingTop'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingBottom'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingLeft'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingRight'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Grid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'gridAxisType'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'spaceX'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'spaceY'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingLeft'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingRight'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingTop'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingBottom'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Horizontal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'spaceX'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingLeft'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingRight'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listType <span class="token operator">==</span> ListType<span class="token punctuation">.</span>Vertical<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'spaceY'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingTop'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cc<span class="token punctuation">.</span>Class<span class="token punctuation">.</span>Attr<span class="token punctuation">.</span><span class="token function">setClassAttr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'paddingBottom'</span><span class="token punctuation">,</span> <span class="token string">'visible'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    <span class="token comment">/** 开始滚动 */</span>
    <span class="token function">onScrollBegin</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>startScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 滚动结束 */</span>
    <span class="token function">onScrollEnded</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>startScroll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 列表滚动 */</span>
    <span class="token function">onScrolling</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>bScrolling <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 列表滚动到顶部 */</span>
    <span class="token function">onScrollToTop</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollTopEvent<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollTopEvent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 列表滚动到底部 */</span>
    <span class="token function">onScrollToBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollBottomEvent<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>scrollBottomEvent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><br> <h2 id="四-使用方式"><a href="#四-使用方式" class="header-anchor">#</a> 四. 使用方式</h2> <h3 id="_1-控制面板"><a href="#_1-控制面板" class="header-anchor">#</a> 1. 控制面板</h3> <p><img src="/assets/img/220112002.3621a383.png" alt=""></p> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">功能</th></tr></thead> <tbody><tr><td style="text-align:left;">listType</td> <td style="text-align:left;">排列方式：水平、垂直、网格三种方式</td></tr> <tr><td style="text-align:left;">listItem</td> <td style="text-align:left;">列表项：node 节点</td></tr> <tr><td style="text-align:left;">itemName</td> <td style="text-align:left;">列表项：脚本名称</td></tr> <tr><td style="text-align:left;">gridAxisType</td> <td style="text-align:left;">网格布局方向：（水平、垂直） (<code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">spaceX</td> <td style="text-align:left;">列表项间的 X 轴间距 (<code>lsitType = ListType.Horizontal</code> 和 <code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">spaceY</td> <td style="text-align:left;">列表项间的 Y 轴间距 (<code>lsitType = ListType.Vertical</code> 和 <code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">paddingTop</td> <td style="text-align:left;">列表上间距 (<code>lsitType = ListType.Vertical</code> 和 <code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">paddingBottom</td> <td style="text-align:left;">列表下间距 (<code>lsitType = ListType.Vertical</code> 和 <code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">paddingLeft</td> <td style="text-align:left;">列表上间距 (<code>lsitType = ListType.Horizontal</code> 和 <code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">paddingRight</td> <td style="text-align:left;">列表上间距 (<code>lsitType = ListType.Horizontal</code> 和 <code>lsitType = ListType.Grid</code> 时会显示)</td></tr> <tr><td style="text-align:left;">scrollTopEvent</td> <td style="text-align:left;">列表: 滚动到 顶部/左部 时会触发该回调</td></tr> <tr><td style="text-align:left;">scrollBottomEvent</td> <td style="text-align:left;">列表: 滚动到 底部/右部 时会触发该回调</td></tr></tbody></table> <h3 id="_2-代码"><a href="#_2-代码" class="header-anchor">#</a> 2. 代码</h3> <h4 id="a-导入自定义组件"><a href="#a-导入自定义组件" class="header-anchor">#</a> a. 导入自定义组件:</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> ListView <span class="token keyword">from</span> <span class="token string">&quot;../public_util/ListView&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="b-定义组件"><a href="#b-定义组件" class="header-anchor">#</a> b. 定义组件:</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>properties<span class="token operator">:</span> <span class="token punctuation">{</span>
	titleL<span class="token operator">:</span> 	cc<span class="token punctuation">.</span>Label<span class="token punctuation">,</span>
    listView<span class="token operator">:</span> 	ListView<span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="c-初始化列表"><a href="#c-初始化列表" class="header-anchor">#</a> c. 初始化列表:</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>	<span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="d-item代码"><a href="#d-item代码" class="header-anchor">#</a> d.Item代码:</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cc<span class="token punctuation">.</span><span class="token function">Class</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> cc<span class="token punctuation">.</span>Component<span class="token punctuation">,</span>

    properties<span class="token operator">:</span> <span class="token punctuation">{</span>

        indexL<span class="token operator">:</span> cc<span class="token punctuation">.</span>Label<span class="token punctuation">,</span>
        nameL<span class="token operator">:</span> cc<span class="token punctuation">.</span>Label<span class="token punctuation">,</span>

		<span class="token comment">// 数据</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

		<span class="token comment">// 索引</span>
        itemIndex<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            visible<span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 列表数据改变时触发 */</span>
    <span class="token function">dataChanged</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>indexL<span class="token punctuation">.</span>string <span class="token operator">=</span> <span class="token string">'第'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>itemIndex <span class="token operator">+</span> <span class="token string">'位'</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>nameL<span class="token punctuation">.</span>string  <span class="token operator">=</span> <span class="token string">'名称: '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="e-常用方法"><a href="#e-常用方法" class="header-anchor">#</a> e. 常用方法:</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token comment">/** 在末尾添加一项 */</span>
    <span class="token function">onClickAddOne</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> window<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span><span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 在末尾添加一组 */</span>
    <span class="token function">onClickAddList</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> window<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span><span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> window<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span><span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">addItems</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 随机移除一项 */</span>
    <span class="token function">onClickRemove</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> index <span class="token operator">=</span> window<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span><span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">deleteItem</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 更新某项数据 */</span>
    <span class="token function">onClickUpdate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> window<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span><span class="token function">getRandomInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">changeItem</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 手动滚动到顶部 */</span>
    <span class="token function">onClickScrollToTop</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">scrollToTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 手动滚动到底部 */</span>
    <span class="token function">onClickScrollToBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">scrollToBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 手动滚动到某一项 */</span>
    <span class="token function">onClickScrollToIndex</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>listView<span class="token punctuation">.</span><span class="token function">scrollToIndex</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 回调: 滑到底部 */</span>
    <span class="token function">onScrollBottom</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 做上拉加载逻辑</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onClickAddList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'滑到底部了。。。。。。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/** 回调: 滑到顶部 */</span>
    <span class="token function">onScrollTop</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'滑到顶部了。。。。。。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/game/04性能优化/优化包体大小.html" class="prev">
        如何优化包体大小
      </a></span> <span class="next"><a href="/game/04性能优化/TexturePacker.html">
        TexturePacker黑边问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.22d06e00.js" defer></script><script src="/assets/js/3.76a73c92.js" defer></script><script src="/assets/js/29.6950f0e0.js" defer></script>
  </body>
</html>
