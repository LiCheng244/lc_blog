<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>iOS开发 - APP 的生命周期 | LiCheng</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Hello, my friend!">
    <link rel="preload" href="/assets/css/0.styles.339bfd79.css" as="style"><link rel="preload" href="/assets/js/app.d6e79a92.js" as="script"><link rel="preload" href="/assets/js/2.618b1e05.js" as="script"><link rel="preload" href="/assets/js/4.16944ab2.js" as="script"><link rel="prefetch" href="/assets/js/10.a08359a6.js"><link rel="prefetch" href="/assets/js/11.0c73a8aa.js"><link rel="prefetch" href="/assets/js/12.57403df7.js"><link rel="prefetch" href="/assets/js/13.58bd7ead.js"><link rel="prefetch" href="/assets/js/14.d01f8dab.js"><link rel="prefetch" href="/assets/js/15.17b89253.js"><link rel="prefetch" href="/assets/js/16.b83fd53a.js"><link rel="prefetch" href="/assets/js/17.c31bf76b.js"><link rel="prefetch" href="/assets/js/18.9ec5010b.js"><link rel="prefetch" href="/assets/js/19.8df7bf95.js"><link rel="prefetch" href="/assets/js/20.89bcfc28.js"><link rel="prefetch" href="/assets/js/21.e6442c6c.js"><link rel="prefetch" href="/assets/js/22.d2518ef4.js"><link rel="prefetch" href="/assets/js/23.7dc260e4.js"><link rel="prefetch" href="/assets/js/24.2578a806.js"><link rel="prefetch" href="/assets/js/25.6e62215b.js"><link rel="prefetch" href="/assets/js/26.c496238a.js"><link rel="prefetch" href="/assets/js/27.94a6caf4.js"><link rel="prefetch" href="/assets/js/28.31431aee.js"><link rel="prefetch" href="/assets/js/29.5a5d98db.js"><link rel="prefetch" href="/assets/js/3.e69c1a0c.js"><link rel="prefetch" href="/assets/js/30.05794d7d.js"><link rel="prefetch" href="/assets/js/31.4f014a3b.js"><link rel="prefetch" href="/assets/js/32.eb16534a.js"><link rel="prefetch" href="/assets/js/33.bdde09bb.js"><link rel="prefetch" href="/assets/js/34.57cca84f.js"><link rel="prefetch" href="/assets/js/35.b5f17239.js"><link rel="prefetch" href="/assets/js/5.086f51c9.js"><link rel="prefetch" href="/assets/js/6.57148270.js"><link rel="prefetch" href="/assets/js/7.3d33aabd.js"><link rel="prefetch" href="/assets/js/8.95801100.js"><link rel="prefetch" href="/assets/js/9.358c01d9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.339bfd79.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.ico" alt="LiCheng" class="logo"> <span class="site-name can-hide">LiCheng</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/ios/" class="nav-link router-link-active">
  iOS
</a></div><div class="nav-item"><a href="/game/" class="nav-link">
  Game
</a></div><div class="nav-item"><a href="https://github.com/LiCheng244/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/ios/" class="nav-link router-link-active">
  iOS
</a></div><div class="nav-item"><a href="/game/" class="nav-link">
  Game
</a></div><div class="nav-item"><a href="https://github.com/LiCheng244/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/ios/00基础知识/" class="sidebar-heading clickable open"><span>基础知识</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/ios/00基础知识/1970.html" class="sidebar-link">iOS开发 - 计算机时间要从1970年1月1日开始算起？</a></li><li><a href="/ios/00基础知识/代码规范.html" class="sidebar-link">iOS开发 - 开发中的代码规范</a></li><li><a href="/ios/00基础知识/开发流程.html" class="sidebar-link">iOS开发 - 移动终端开发工作流程</a></li><li><a href="/ios/00基础知识/入行须知.html" class="sidebar-link">iOS开发 - 入行须知</a></li><li><a href="/ios/00基础知识/沙盒机制.html" class="sidebar-link">iOS开发 - 关于沙盒机制(sandBox)</a></li><li><a href="/ios/00基础知识/四层系统架构.html" class="sidebar-link">iOS开发 - 四层系统架构</a></li><li><a href="/ios/00基础知识/正则表达式.html" class="sidebar-link">iOS开发 - 正则表达式 系统学习</a></li><li><a href="/ios/00基础知识/App生命周期.html" class="active sidebar-link">iOS开发 - APP 的生命周期</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/ios/00基础知识/Controller生命周期.html" class="sidebar-link">iOS开发 - ViewController 的生命周期</a></li><li><a href="/ios/00基础知识/mac快捷键.html" class="sidebar-link">iOS开发 - MAC 快捷键大全</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/ios/01OC知识/" class="sidebar-heading clickable"><span>OC知识</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="i-程序启动"><a href="#i-程序启动" class="header-anchor">#</a> I. 程序启动</h3> <hr> <h4 id="_1-程序启动的完整过程"><a href="#_1-程序启动的完整过程" class="header-anchor">#</a> 1. 程序启动的完整过程:</h4> <ul><li>创建 UIApplication 对象</li> <li>创建 UIApplication 的 delegate 对象 delegate对象开始处理(监听)系统事件(没有 storyboard)</li> <li>程序启动完毕的时候, 就会调用代理的<code>application:didFinishLaunchingWithOptions:</code>方法</li> <li>在<code>application:didFinishLaunchingWithOptions:</code>中创建UIWindow</li> <li>创建和设置 UIWindow 的 rootViewController</li> <li>显示窗口 根据Info.plist获得最主要storyboard的文件名,加载最主要的storyboard(有storyboard)</li> <li>创建UIWindow</li> <li>创建和设置UIWindow的rootViewController</li> <li>显示窗口</li></ul> <p><img src="/assets/img/19010100.c411fcdc.jpg" alt=""></p> <h4 id="_2-uiapplicationmain"><a href="#_2-uiapplicationmain" class="header-anchor">#</a> 2. UIApplicationMain:</h4> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token expression"><span class="token operator">&lt;</span>UIKit<span class="token operator">/</span>UIKit<span class="token punctuation">.</span>h<span class="token operator">&gt;</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token string">&quot;AppDelegate.h&quot;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">@</span>autoreleasepool <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token function">UIApplicationMain</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> nil<span class="token punctuation">,</span> <span class="token function">NSStringFromClass</span><span class="token punctuation">(</span><span class="token punctuation">[</span>AppDelegate class<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>main</code>函数中执行了一个<code>UIApplicationMain</code>这个函数:
<code>intUIApplicationMain(int argc, char *argv[], NSString *principalClassName, NSString *delegateClassName);</code></p> <h5 id="argc、argv："><a href="#argc、argv：" class="header-anchor">#</a> argc、argv：</h5> <p>直接传递给UIApplicationMain进行相关处理即可</p> <h5 id="principalclassname："><a href="#principalclassname：" class="header-anchor">#</a> principalClassName：</h5> <p>指定应用程序类名（app的象征），该类必须是UIApplication(或子类)。如果为nil,则用UIApplication类作为默认值</p> <h5 id="delegateclassname："><a href="#delegateclassname：" class="header-anchor">#</a> delegateClassName：</h5> <p>指定应用程序的代理类，该类必须遵守UIApplicationDelegate协议
UIApplicationMain函数会根据<code>principalClassName</code>创建UIApplication对象，根据delegateClassName创建一个delegate对象，并将该delegate对象赋值给UIApplication对象中的delegate属性
接着会建立应用程序的Main Runloop（事件循环），进行事件的处理(首先会在程序完毕后调用delegate对象的<code>application:didFinishLaunchingWithOptions:</code>方法)</p> <p>程序正常退出时UIApplicationMain函数才返回。</p> <br>
### 二 UIApplication
___
#### 1. 简单介绍：
1. UIApplication对象是应用程序的象征，一个UIApplication对象就代表一个应用程序。
2. 每一个应用都有自己的UIApplication对象，而且是单例的，如果试图在程序中新建一个UIApplication对象，那么将报错提示。
3. 通过`[UIApplication sharedApplication]`可以获得这个单例对象
4. 一个iOS程序启动后创建的第一个对象就是UIApplication对象，且只有一个（通过代码获取两个UIApplication对象，打印地址可以看出地址是相同的）。
5. 利用UIApplication对象，能进行一些应用级别的操作。
<h4 id="_2-应用级别的操作"><a href="#_2-应用级别的操作" class="header-anchor">#</a> 2. 应用级别的操作:</h4> <p><strong>1）设置应用程序图标右上角的红色提醒数字（如QQ消息的时候，图标上面会显示1，2，3条新信息等）</strong></p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token comment">/**
* iOS8以后需要注册,才能将未读的数在图标右上角显示
*/</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>IS_IOS_8Later<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token comment">// 使用本地通知 (本例中只是badge，但是还有alert和sound都属于通知类型,其实如果只进行未读数在appIcon显示,只需要badge就可, 这里全写上为了方便以后的使用)</span>
UIUserNotificationSettings <span class="token operator">*</span>settings <span class="token operator">=</span> <span class="token punctuation">[</span>UIUserNotificationSettings settingsForTypes<span class="token punctuation">:</span>UIUserNotificationTypeBadge <span class="token operator">|</span> UIUserNotificationTypeSound <span class="token operator">|</span> UIUserNotificationTypeAlert categories<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 进行注册</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span> registerUserNotificationSettings<span class="token punctuation">:</span>settings<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置角标</span>
<span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span><span class="token punctuation">.</span>applicationIconBadgeNumber <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>2）设置联网指示器的可见性</strong></p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token comment">// 设置联网指示器可见性 - 显示</span>
<span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span><span class="token punctuation">.</span>networkActivityIndicatorVisible <span class="token operator">=</span> YES<span class="token punctuation">;</span>·
</code></pre></div><p><strong>3）管理状态栏</strong></p> <p>如果想利用UIApplication来管理状态栏，首先得修改Info.plist的设置：
<img src="/assets/img/19010101.c37e73c2.png" alt=""></p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token comment">// 黑色</span>
<span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span><span class="token punctuation">.</span>statusBarStyle <span class="token operator">=</span> UIStatusBarStyleDefault<span class="token punctuation">;</span>

<span class="token comment">// 白色 + 动画</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span> setStatusBarStyle<span class="token punctuation">:</span><span class="token punctuation">(</span>UIStatusBarStyleLightContent<span class="token punctuation">)</span> animated<span class="token punctuation">:</span>YES<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 隐藏状态栏</span>
<span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span><span class="token punctuation">.</span>statusBarHidden <span class="token operator">=</span> YES<span class="token punctuation">;</span>

<span class="token comment">// 隐藏 + 动画效果</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span> setStatusBarHidden<span class="token punctuation">:</span>YES withAnimation<span class="token punctuation">:</span><span class="token punctuation">(</span>UIStatusBarAnimationFade<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>** 4）openURL:方法 **</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code>UIApplication <span class="token operator">*</span>app <span class="token operator">=</span> <span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 打电话</span>
<span class="token punctuation">[</span>app openURL<span class="token punctuation">:</span><span class="token punctuation">[</span>NSURL URLWithString<span class="token punctuation">:</span><span class="token operator">@</span>&quot;tel<span class="token punctuation">:</span><span class="token comment">//10086&quot;]];</span>
<span class="token comment">// 发短信</span>
<span class="token punctuation">[</span>app openURL<span class="token punctuation">:</span><span class="token punctuation">[</span>NSURL URLWithString<span class="token punctuation">:</span><span class="token operator">@</span>&quot;sms<span class="token punctuation">:</span><span class="token comment">//10086&quot;]];</span>
<span class="token comment">// 发邮件</span>
<span class="token punctuation">[</span>app openURL<span class="token punctuation">:</span><span class="token punctuation">[</span>NSURL URLWithString<span class="token punctuation">:</span><span class="token operator">@</span>&quot;mailto<span class="token punctuation">:</span><span class="token comment">//12345@qq.com&quot;]];</span>
<span class="token comment">// 打开一个网页资源</span>
<span class="token punctuation">[</span>app openURL<span class="token punctuation">:</span><span class="token punctuation">[</span>NSURL URLWithString<span class="token punctuation">:</span><span class="token operator">@</span>&quot;http<span class="token punctuation">:</span><span class="token comment">//ios.itcast.cn&quot;]];</span>
</code></pre></div><p>openURL方法，也可以打开其他APP。</p> <p>URL：统一资源定位符，用来唯一的表示一个资源。
URL格式:协议头：//主机地址/资源路径
网络资源：http/ ftp等 表示百度上一张图片的地址http://www.baidu.com/images/20140603/abc.png
本地资源：file:///users/apple/desktop/abc.png(主机地址省略)</p> <br>
### III. UIApplication Delegate
___
#### 1. delegate方法:
UIApplication程序启动过程相关的一些delegate方法的调用时机。
<div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>application<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application didFinishLaunchingWithOptions<span class="token punctuation">:</span><span class="token punctuation">(</span>NSDictionary <span class="token operator">*</span><span class="token punctuation">)</span>launchOptions <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;程序启动完成：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> YES<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidBecomeActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经获得焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillResignActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要释放焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidEnterBackground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经进入后台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillEnterForeground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要进入前台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillTerminate<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;程序将要退出：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-程序启动"><a href="#_2-程序启动" class="header-anchor">#</a> 2. 程序启动:</h4> <p>程序被加载到内存，完成启动，<code>application</code>对象会自动调用<code>delegate</code>的下面这个方法，证明程序已经启动完成。所以这个方法也是首先会被<code>application</code>回调的方法，且这个方法在整个程序的生命周期中只会被调用一次。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>application<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application didFinishLaunchingWithOptions<span class="token punctuation">:</span><span class="token punctuation">(</span>NSDictionary <span class="token operator">*</span><span class="token punctuation">)</span>launchOptions<span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;程序启动完成：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> YES<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>程序启动时，回调完上面的方法，会继续回调<code>delegate</code>的已经获得了焦点的方法，证明程序已经获得了焦点。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidBecomeActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经获得焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="结论："><a href="#结论：" class="header-anchor">#</a> 结论：</h5> <blockquote><p>应用启动过程中，会依次调用delegate已经启动完成和已经获得焦点的方法，不会调用已经进入前台的方法。</p></blockquote> <h4 id="_3-程序从前台退出到后台"><a href="#_3-程序从前台退出到后台" class="header-anchor">#</a> 3. 程序从前台退出到后台:</h4> <p>当程序处于前台时,单击home键，程序会自动退出到后台。在这个过程中，程序会先回调<code>delegate</code>的将要失去焦点的方法，证明程序<strong>将要失去焦点</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillEnterForeground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要进入前台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>调用调用完上面的方法后，程序紧接着会调用<code>delegate</code>已经进入后台的方法，证明<strong>程序已经进入后台</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidEnterBackground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经进入后台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="结论：-2"><a href="#结论：-2" class="header-anchor">#</a> 结论：</h5> <blockquote><p>单击home键进入后台会依次调用delegate的将要失去焦点的方法和已经进入后台的方法。</p></blockquote> <h4 id="_4-程序从后台进入到前台"><a href="#_4-程序从后台进入到前台" class="header-anchor">#</a> 4. 程序从后台进入到前台:</h4> <p>从后台进入前台(无论是双击home键进入或者点击应用图标进入)，会回调<code>delegate</code>的将要进入前台方法，证明<strong>程序将要进入前台</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillEnterForeground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要进入前台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>回调完上面的方法，紧接着会继续回调<code>delegate</code>的已经获得焦点的方法，证明程序<strong>已经获得了焦点</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidBecomeActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经获得焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="结论：-3"><a href="#结论：-3" class="header-anchor">#</a> 结论：</h5> <blockquote><p>从后台进入前台，会依次调用delegate的将要进入前台和已经获得焦点的方法。</p></blockquote> <h4 id="_5-双击home键切换程序"><a href="#_5-双击home键切换程序" class="header-anchor">#</a> 5. 双击home键切换程序:</h4> <p>在前台，双击home键，只会调用<code>delegate</code>的将要失去焦点的方法，证明程序<strong>将要失去焦点</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillResignActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要释放焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当用户真正切换应用时候，才会继续调用<code>delegate</code>的已经进入后台的方法，证明<strong>程序已经进入后台</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidEnterBackground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经进入后台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="结论：-4"><a href="#结论：-4" class="header-anchor">#</a> 结论：</h5> <blockquote><p>双击home键切换应用。会分别调用程序将要失去焦点的方法和程序已经进入后台的方法。 且这两个方法是分开调用的。即，双击home键时调用将要失去焦点的方法，选择其他应用时调用已经进入后台的方法。</p></blockquote> <h4 id="_6-在前台双击home键杀死程序"><a href="#_6-在前台双击home键杀死程序" class="header-anchor">#</a> 6. 在前台双击home键杀死程序:</h4> <p>双击home键时，只会调用<code>delegate</code>的将要失去焦点的方法（上面已经说过）,证明<strong>程序将要失去焦点</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillResignActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要释放焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后手指上滑杀死程序，会直接调用<code>delegate</code>的已经进入后台的方法，证明<strong>程序已经进入后台</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidEnterBackground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经进入后台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后紧接着调用<code>delegate</code>的程序将要退出的方法，<strong>证明程序将要被杀死</strong>。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillTerminate<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;程序将要退出：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="结论：-5"><a href="#结论：-5" class="header-anchor">#</a> 结论：</h5> <blockquote><p>双击home键然后杀死程序，会按照如下顺序调用delegate的方法：</p></blockquote> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token comment">// 双击 home 键调用</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillResignActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要释放焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 杀死程序时调用这两个方法</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidEnterBackground<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经进入后台：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillTerminate<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;程序将要退出：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_7-从其他程序前台双击home键杀死后台程序"><a href="#_7-从其他程序前台双击home键杀死后台程序" class="header-anchor">#</a> 7. 从其他程序前台双击home键杀死后台程序:</h4> <p>如果从其他程序的前台，双击home键杀死后台程序，被杀死程序只会回调<code>delegate</code>即将退出的方法。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillTerminate<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;程序将要退出：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>为什么呢？</strong></p> <p>因为我们是从一个前台程序杀死一个后台程序，这个后台程序当初进入后台时候已经调用了将要释放焦点和已经进入后台的方法，所以杀死时候只会回调<code>delegate</code>即将终结的方法。</p> <h5 id="结论：-6"><a href="#结论：-6" class="header-anchor">#</a> 结论：</h5> <blockquote><p>从一个前台程序杀死一个后台程序。后台程序只会回调delegate的程序即将退出的方法。</p></blockquote> <h4 id="_8-下拉通知栏"><a href="#_8-下拉通知栏" class="header-anchor">#</a> 8. 下拉通知栏:</h4> <p>下拉通知栏，只会回调<code>delegate</code>的<strong>程序将要释放焦点</strong>的方法。程序并没有进入后台，所以不会调用进入后台的方法。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationWillResignActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;将要释放焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>收起通知栏时，只会调用<strong>已经获得焦点</strong>的方法，不会调用进入前台的方法。</p> <div class="language-objectivec extra-class"><pre class="language-objectivec"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>applicationDidBecomeActive<span class="token punctuation">:</span><span class="token punctuation">(</span>UIApplication <span class="token operator">*</span><span class="token punctuation">)</span>application <span class="token punctuation">{</span>
<span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;已经获得焦点：%s&quot;</span><span class="token punctuation">,</span><span class="token constant">__func__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>同样，从屏幕下方向上滑动屏幕，唤出工具栏时候，也只会调用delegate的将要释放焦点的方法。收起工具栏时，只会调用delegate的已经获得焦点的方法。</p> <h5 id="结论：-7"><a href="#结论：-7" class="header-anchor">#</a> 结论：</h5> <blockquote><p>下拉通知栏或者上拉工具栏，都只是回调delegate的即将释放焦点的方法，程序不会进入后台。</p></blockquote> <h4 id="_9-总结"><a href="#_9-总结" class="header-anchor">#</a> 9. 总结</h4> <p>当初学习iOS时候，对这个地方不是很清楚，总是搞不懂为什么程序的delegate有一个将要进入前台的方法<code>applicationWillEnterForeground:</code>，却没有类似于<code>applicationDidEnterForeground:</code>的已经进入前台的方法(纯属捏造)？为什么程序的delegate有一个已经进入后台的方法<code>applicationDidEnterBackground:</code>却没有一个类似于<code>applicationWillEnterBackground:</code>的将要进入后台的方法？为什么进入前台时，方法的调用顺序是<code>applicationWillEnterForeground:</code>和<code>applicationDidBecomeActive:</code>而不是相反？这些问题一直困扰着我。</p> <p><strong>将要进入前台、已经获得焦点、将要失去焦点、已经进入后台</strong>这几个方法是比较容易混淆的，且调用顺序经常被搞混。但是如果理解了苹果为什么这么设计，这些困惑都将迎刃而解。重点来了：如果一个应用程序失去焦点那么意味着用户当前无法进行交互操作，正因如此，程序从前台退出到后台时候，一般会<strong>先失去焦点再进入后台</strong>避免进入后台过程中用户还可以和程序进行交互。同理，一个应用程序从后台进入前台也是类似的，会<strong>先进入前台再获得焦点</strong>，这样进入前台过程中未完全准备好的情况下用户无法操作，保证了程序的安全性。</p> <p>至于为什么苹果没有提供类似于<code>applicationDidEnterForeground:</code>的已经进入前台的方法，那是因为程序进入前台后必定会回调delegate的已经获得焦点的方法，所以<code>applicationDidBecomeActive:</code>方法从本质上就相当于我们想象中的<code>applicationDidEnterForeground:</code>，如果我们想要在程序进入前台后做什么操作，完全可以把这些操作写到<code>applicationDidBecomeActive:</code>里。同理，<code>applicationWillResignActive:</code>就相当于我们想象中的<code>applicationWillEnterForeground:</code>。</p> <p>另外一般如果<strong>应用程序要保存用户数据会在程序将要失去焦点的方法中进行 （而不是在已经进入后台的方法中执行）</strong>，因为如果用户双击Home不会进入后台只会注销激活。同理，如果用户恢复应用状态一般在已经获的焦点的方法中执行（而不是在将要进入前台的方法中执行）。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ios/00基础知识/正则表达式.html" class="prev">
        iOS开发 - 正则表达式 系统学习
      </a></span> <span class="next"><a href="/ios/00基础知识/Controller生命周期.html">
        iOS开发 - ViewController 的生命周期
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d6e79a92.js" defer></script><script src="/assets/js/2.618b1e05.js" defer></script><script src="/assets/js/4.16944ab2.js" defer></script>
  </body>
</html>
