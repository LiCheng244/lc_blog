(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{229:function(t,a,s){t.exports=s.p+"assets/img/20101506.96be70d7.png"},230:function(t,a,s){t.exports=s.p+"assets/img/20101507.8eadc601.png"},231:function(t,a,s){t.exports=s.p+"assets/img/20101508.a73b568e.png"},510:function(t,a,s){"use strict";s.r(a);var e=s(6),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",[t._v(" 关于 静态合图 ")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("前言")]),t._v(" "),e("p",[t._v("动态合图（Dynamic Atlas）。")])]),t._v(" "),e("br"),t._v(" "),e("h2",{attrs:{id:"一-动态合图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一-动态合图"}},[t._v("#")]),t._v(" 一. 动态合图")]),t._v(" "),e("p",[t._v("Cocos Creator 提供了在项目构建时的静态合图方法 —— "),e("code",[t._v("「自动合图」")]),t._v("（Auto Atlas）。但是当项目日益壮大的时候贴图会变得非常多，很难将贴图打包到一张大贴图中，这时静态合图就比较难以满足降低 DrawCall 的需求。所以 Cocos Creator 在 v2.0 中加入了 "),e("code",[t._v("「动态合图」")]),t._v("（Dynamic Atlas）的功能，它能在项目运行时动态的将贴图合并到一张大贴图中。当渲染一张贴图的时候，动态合图系统会自动检测这张贴图是否已经被合并到了图集（图片集合）中，如果没有，并且此贴图又符合动态合图的条件，就会将此贴图合并到图集中。")]),t._v(" "),e("blockquote",[e("p",[t._v("动态合图官方文档："),e("a",{attrs:{href:"https://docs.cocos.com/creator/manual/zh/advanced-topics/dynamic-atlas.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.cocos.com/creator/manual/zh/advanced-topics/dynamic-atlas.html"),e("OutboundLink")],1)])]),t._v(" "),e("br"),t._v(" "),e("p",[t._v("简单来说，开启动态合图之后，引擎会在运行时帮我们对符合条件（即尺寸小于碎图限制的最大尺寸）的精灵进行合图，达到和提前打包图集一样的效果。")]),t._v(" "),e("p",[t._v("引擎的"),e("code",[t._v("「动态图集尺寸最大是 2048 * 2048」")]),t._v("，可合并的"),e("code",[t._v("「碎图限制的最大尺寸是 512」")]),t._v("，用户可以通过下面的 API 进行修改：")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("cc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamicAtlasManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("maxFrameSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("code",[t._v("「启用动态合图会占用额外的内存」")]),t._v("，不同平台占用的内存大小不一样。")]),t._v(" "),e("p",[t._v("小游戏和原生平台上默认会禁用动态合图，但如果你的项目内存空间仍有富余的话建议强制开启：")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("cc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("macro"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLEANUP_IMAGE_CACHE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dynamicAtlasManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("enabled "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("br"),t._v(" "),e("p",[t._v("另外还需要保证纹理的 "),e("code",[t._v("Premulyiply Alpha（预乘）")]),t._v(" 、"),e("code",[t._v("Wrap Mode（循环模式）")]),t._v(" 和 "),e("code",[t._v("Filter Mode（过滤模式）")]),t._v(" 等信息与动态图集一致才能够动态合批。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(229),alt:""}})]),t._v(" "),e("br"),t._v(" "),e("h2",{attrs:{id:"二-静态图集参与动态合图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二-静态图集参与动态合图"}},[t._v("#")]),t._v(" 二. 静态图集参与动态合图")]),t._v(" "),e("p",[t._v("在动态合图的官方文档中有提到：")]),t._v(" "),e("blockquote",[e("p",[t._v("当渲染一张贴图的时候，动态合图系统会自动检测这张贴图是否已经被合并到了图集（图片集合）中，如果没有，并且此贴图又符合动态合图的条件，就会将此贴图合并到图集中。")])]),t._v(" "),e("p",[t._v("但其实"),e("code",[t._v("「只要静态图集满足动态合图的要求（即尺寸小于碎图限制的最大尺寸），也是可以参与动态合图的」")]),t._v("。")]),t._v(" "),e("p",[t._v("注意：自动图集资源（Auto Atlas）需要在其属性检查器面板中开启 "),e("code",[t._v("「Texture」")]),t._v(" 栏下的 "),e("code",[t._v("「Packable」")]),t._v("选项，该选项默认是禁用的。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(230),alt:""}})]),t._v(" "),e("br"),t._v(" "),e("h2",{attrs:{id:"三-额外补充"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三-额外补充"}},[t._v("#")]),t._v(" 三. 额外补充")]),t._v(" "),e("p",[e("code",[t._v("「只有纹理开启了 Packable 选项的精灵才能够参与动态合图」")]),t._v("，该选项默认开启。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(231),alt:""}})]),t._v(" "),e("p",[t._v("纹理参与动态合图后会修改原始贴图的 UV 坐标，所以在 Shader 中的无法正确计算 UV 坐标，导致 Shader 无效。")]),t._v(" "),e("p",[e("code",[t._v("「如果需要对精灵使用自定义 Shader，需要禁用其纹理的 Packable 选项。」")])]),t._v(" "),e("p",[t._v("也可以在代码中禁用该选项：")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sprite "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("node"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getComponent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sprite"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" texture "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sprite"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spriteFrame"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTexture")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ntexture"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("packable "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("Packable 官方文档："),e("a",{attrs:{href:"https://docs.cocos.com/creator/manual/zh/asset-workflow/sprite.html?h=packable",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.cocos.com/creator/manual/zh/asset-workflow/sprite.html?h=packable"),e("OutboundLink")],1)])]),t._v(" "),e("br")])}),[],!1,null,null,null);a.default=r.exports}}]);