(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{207:function(t,a,s){"use strict";s.r(a);var n=s(6),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("hr"),t._v(" "),s("h3",{attrs:{id:"i-对象为什么要alloc，init又是干嘛的？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#i-对象为什么要alloc，init又是干嘛的？"}},[t._v("#")]),t._v(" I. 对象为什么要alloc，init又是干嘛的？")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("很多人都知道，初始化一个对象应该这么写:")]),t._v(" "),s("div",{staticClass:"language-objectivec extra-class"},[s("pre",{pre:!0,attrs:{class:"language-objectivec"}},[s("code",[t._v("MyClass"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" myObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MyClass alloc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("那么有没有思考过为什么呢？其实我这么写也是完全可以的：")]),t._v(" "),s("div",{staticClass:"language-objectivec extra-class"},[s("pre",{pre:!0,attrs:{class:"language-objectivec"}},[s("code",[t._v("MyClass "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("myObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MyClass alloc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmyObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("myObj init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),t._v(" "),s("h4",{attrs:{id:"上面第一行代码的意思是"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上面第一行代码的意思是"}},[t._v("#")]),t._v(" 上面第一行代码的意思是:")]),t._v(" "),s("p",[s("code",[t._v("alloc")]),t._v("了一坨内存给"),s("code",[t._v("myObj")]),t._v("对象, 让它不释放, 并且把地址返回给指针; 但是这样过后, "),s("code",[t._v("myObj")]),t._v("是不能使用的。\n为什么呢? 因为这段代码还没有被正确的初始化;")]),t._v(" "),s("h4",{attrs:{id:"举个例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#举个例子"}},[t._v("#")]),t._v(" 举个例子:")]),t._v(" "),s("blockquote",[s("p",[t._v("比如公司要盖一个基地, 那第一步就是先要向政府申请一块地皮, 第二步才能在这块地皮上进行动工盖楼;\n这里操作系统就是政府, alloc就是去申请地皮, init就是在盖房子; 如果没有调用init, 房子都没有修好, 别人怎么去住?")])]),t._v(" "),s("br"),t._v("\n### II. 关于alloc\n____\nalloc的主要功能就是：`分配了一坨内存 给myObj对象, 让它不释放, 并且把地址返回给指针`\n"),s("h4",{attrs:{id:"调用alloc后内存是直接映射到堆还是只分配给了虚拟内存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调用alloc后内存是直接映射到堆还是只分配给了虚拟内存"}},[t._v("#")]),t._v(" 调用alloc后内存是直接映射到堆还是只分配给了虚拟内存?")]),t._v(" "),s("p",[t._v("先了解一下内存:")]),t._v(" "),s("ul",[s("li",[t._v("**Clean Memory: ** 可以被操作系统回收的,在闪存中有备份, 能够再次读取重建。(包括: 代码段, framework等等)")]),t._v(" "),s("li",[t._v("**Dirty Memory: **不可被操作系统回收的, 所有非Clean Memory。(包括:被分配了的堆控件, image cache等等)")])]),t._v(" "),s("p",[s("strong",[t._v("结论： alloc不只分配在虚拟内存，同时会在物理内存建立映射。")])]),t._v(" "),s("h4",{attrs:{id:"这一坨内存到底是多大？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#这一坨内存到底是多大？"}},[t._v("#")]),t._v(" 这一坨内存到底是多大？")]),t._v(" "),s("p",[t._v("内存分配采用的是: "),s("strong",[t._v("字节对齐的方式.")]),t._v("\n**字节对齐: **")]),t._v(" "),s("blockquote",[s("p",[t._v("当我们分配一块内存的时候，假设需要的内存小于16个字节，操作系统会直接分配16个字节；加入需要的内存大于16个字节，操作系统会分配a*16个字节。举个栗子，如果你调用malloc并且需要4个字节，系统会给你一块16个字节的内存块；如果你调用malloc并且需要24个字节，系统会给你一块32个字节的内存块。")])]),t._v(" "),s("br"),t._v("\n### III. 关于init\n____\n"),s("p",[t._v("init 的主要功能是： "),s("code",[t._v("来初始化这块内存， 只有初始化之后，这个对象才可以使用")])]),t._v(" "),s("p",[t._v("需要调用"),s("code",[t._v("init")]),t._v("来初始化这块内存:")]),t._v(" "),s("div",{staticClass:"language-objectivec extra-class"},[s("pre",{pre:!0,attrs:{class:"language-objectivec"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),t._v(" init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",[s("li",[t._v("需要初始化父类的信息, 比如实例变量等等.(可以理解为: 王思聪在修房子前要询问他老爸的意见，他老爸说想娱乐会所, 他没有意见的话就会修成娱乐会所) ;")]),t._v(" "),s("li",[t._v("自定义一些初始化(可以理解为: 如果王思聪有意见, 那么他会在第二步时, 悄悄改为修成LOL俱乐部) ;")]),t._v(" "),s("li",[t._v("返回初始化好的对象 (可以理解为: 房子修改好了).")])]),t._v(" "),s("hr")])}),[],!1,null,null,null);a.default=e.exports}}]);